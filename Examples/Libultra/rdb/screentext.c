#include <ultra64.h>
#include <string.h>
#include <stdarg.h>
#include "config.h"
#include "screentext.h"

static char screentext_buffer[512];

static u16 CPUFont[] = {
    0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 
    0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
    0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0x01, 0x01, 0x01, 0x01, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0x01, 
};

static void screentext_placechar(char c, u16 x, u16 y);

static void* printf_handler(void *buf, const char *str, size_t len)
{
    return ((char *) memcpy(buf, str, len) + len);
}

void screentext_put(u16 x, u16 y, const char* message, ...)
{
    int i;
    int len = 0;
    u16 ox;
    va_list args;
    
    // Use the internal libultra printf function to format the string
    va_start(args, message);
    len = _Printf(&printf_handler, screentext_buffer, message, args);
    va_end(args);
    
    // Attach the '\0' if necessary
    if (0 <= len)
        screentext_buffer[len] = '\0';
        
    // Place on the screenbuffer
    ox = x;
    for (i=0; i<len+1; i++)
    {
        // Correct the coordinates
        if (x > SCREEN_WD-8)
        {
            x = ox;
            y += 8;
        }
        if (y > SCREEN_HT-8)
            break;
        
        // Handle the characters
        if (screentext_buffer[i] == ' ')
        {
            x += 8;
            continue;
        }
        else if (screentext_buffer[i] == '\n')
        {
            y += 8;
            x = ox;
            continue;
        }
        else
            screentext_placechar(screentext_buffer[i], x, y);
        x += 8;
    }
}

static void screentext_placechar(char c, u16 x, u16 y)
{
    u16* vi;
    int idx, idy;
    int spx, spy;

    // Get the character's top left coordinate on the sprite sheet
    if (c >= '0' && c <= '8')
    {
        spx = (c - '0')*8;
        spy = 0;
    }
    else if (c == '9')
    {
        spx = 0;
        spy = 8;
    }
    else if ((c >= 'A' && c <= 'H') || (c >= 'a' && c <= 'h'))
    {
        spx = (1+((c >= 'a') ? (c-'a') : (c-'A')))*8;
        spy = 8;
    }
    else if ((c >= 'I' && c <= 'Q') || (c >= 'i' && c <= 'q'))
    {
        spx = ((c >= 'i') ? (c-'i') : (c-'I'))*8;
        spy = 16;
    }
    else if ((c >= 'R' && c <= 'Z') || (c >= 'r' && c <= 'z'))
    {
        spx = ((c >= 'r') ? (c-'r') : (c-'R'))*8;
        spy = 24;
    }
    else
        return;
    
    // Draw the character onto the framebuffer   
    vi = (u16*)osViGetCurrentFramebuffer();
    osWritebackDCacheAll();
    for (idy = 0; idy < 8; idy++)
        for (idx = 0; idx < 8; idx++)
            vi[(y+idy)*SCREEN_WD + (x+idx)] = CPUFont[(spy+idy)*72 + (spx+idx)];
    osWritebackDCacheAll();
}